{"version":3,"sources":["../src/adaptive-grid.jsx"],"names":["AdaptiveGridItem","props","style","Component","isFilled","colStart","rowStart","colEnd","rowEnd","arr","forEach","borders","colStart2","rowStart2","colEnd2","rowEnd2","doFill","push","AdaptiveGrid","onResize","bind","state","width","setState","availableWidth","console","log","maxHeight","baseWidth","baseHeight","totalColumns","Math","floor","colWidth","childrenInfo","children","map","child","height","attributes","minWidth","minHeight","cols","ceil","rows","remainingElements","slice","call","remainingElementsIds","Object","keys","childrenCoords","row","boundaries","length","col","elId","childId","splice","i","position","left","top","edge"],"mappings":"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","file":"adaptive-grid.js","sourcesContent":["/**\r\n * @license MIT\r\n * @copyright Kirill Shestakov 2017\r\n * @see https://github.com/guitarino/adaptive-grid--preact/\r\n */\r\n\r\nimport preact from 'preact';\r\nimport ResizeSensor from 'resize-sensor--preact';\r\n\r\nimport './adaptive-grid.css';\r\n\r\nexport class AdaptiveGridItem extends preact.Component {\r\n  render() {\r\n    return (\r\n      <div class=\"AdaptiveGridItem\" style={this.props.style}>Hello there</div>\r\n    )\r\n  }\r\n};\r\n\r\nfunction isFilled(colStart, rowStart, colEnd, rowEnd, arr) {\r\n  var isFilled = false;\r\n  arr.forEach((borders) => {\r\n    var colStart2 = borders[0];\r\n    var rowStart2 = borders[1];\r\n    var colEnd2 = borders[2];\r\n    var rowEnd2 = borders[3];\r\n    if (colStart < colEnd2 && colEnd > colStart2 &&\r\n      rowEnd2 > rowStart && rowStart2 < rowEnd ) {\r\n      isFilled = true;\r\n      return false;\r\n    }\r\n  });\r\n  return isFilled;\r\n}\r\n\r\nfunction doFill(colStart, rowStart, colEnd, rowEnd, arr) {\r\n  arr.push([colStart, rowStart, colEnd, rowEnd]);\r\n}\r\n\r\nexport class AdaptiveGrid extends preact.Component {\r\n  constructor() {\r\n    super();\r\n    this.onResize = this.onResize.bind(this);\r\n    this.state = {width: 0};\r\n  }\r\n  onResize(width) {\r\n    this.setState({width: width});\r\n  }\r\n  render() {\r\n    var availableWidth = this.state.width;\r\n    console.log(availableWidth);\r\n    var maxHeight = 0;\r\n    if (availableWidth > 0) {\r\n      var baseWidth = this.props.baseWidth;\r\n      var baseHeight = this.props.baseHeight;\r\n      var totalColumns = Math.floor(availableWidth / baseWidth);\r\n      var colWidth = availableWidth / totalColumns;\r\n      var childrenInfo = this.props.children.map((child) => {\r\n        var width = baseWidth;\r\n        var height = baseHeight;\r\n        if(child.attributes) {\r\n          if(child.attributes.minWidth) {\r\n            width = child.attributes.minWidth;\r\n          }\r\n          if(child.attributes.minHeight) {\r\n            height = child.attributes.minHeight;\r\n          }\r\n        }\r\n        return {\r\n          cols: Math.ceil(width / baseWidth),\r\n          rows: Math.ceil(height / baseHeight)\r\n        };\r\n      });\r\n      var remainingElements = [].slice.call(this.props.children);\r\n      var remainingElementsIds = Object.keys(this.props.children);\r\n      var childrenCoords = [];\r\n      var row = 0;\r\n      var boundaries = [];\r\n      while(remainingElements.length) {\r\n        for(var col = 0; col < totalColumns; col++) {\r\n          for(var elId = 0; elId < remainingElements.length; elId++) {\r\n            var childId = remainingElementsIds[elId];\r\n            var cols = childrenInfo[childId].cols;\r\n            var rows = childrenInfo[childId].rows;\r\n            if(col + cols <= totalColumns) {\r\n              if(!isFilled(col, row, col + cols, row + rows, boundaries)) {\r\n                remainingElements.splice(elId, 1);\r\n                remainingElementsIds.splice(elId, 1);\r\n                elId--;\r\n                childrenCoords[childId] = [col, row];\r\n                doFill(col, row, col + cols, row + rows, boundaries);\r\n                break;\r\n              }\r\n            }\r\n          }\r\n        }\r\n        row++;\r\n      }\r\n      this.props.children.forEach((child, i) => {\r\n        if (!child.attributes) {\r\n          child.attributes = {};\r\n        }\r\n        child.attributes.style = {\r\n          position: 'absolute',\r\n          left: childrenCoords[i][0] * colWidth + 'px',\r\n          top: childrenCoords[i][1] * baseHeight + 'px',\r\n          width: childrenInfo[i].cols * colWidth + 'px',\r\n          height: childrenInfo[i].rows * baseHeight + 'px'\r\n        };\r\n        var edge = (childrenCoords[i][1] + childrenInfo[i].rows) * baseHeight;\r\n        if (edge > maxHeight) maxHeight = edge;\r\n        // console.log(child.attributes);\r\n      });\r\n    }\r\n    return (\r\n      <div class='AdaptiveGrid' style={{height: maxHeight}}>\r\n        <ResizeSensor\r\n          onResize={this.onResize}\r\n        />\r\n        {this.props.children}\r\n      </div>\r\n    );\r\n  }\r\n}"]}